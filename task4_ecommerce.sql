USE ecommerce_db;

-------------------------------------------------------------------------------
-- 1. Count total users
-------------------------------------------------------------------------------
SELECT COUNT(*) AS total_users
FROM Users;

-------------------------------------------------------------------------------
-- 2. Total stock available for all products
-------------------------------------------------------------------------------
SELECT SUM(stock) AS total_stock
FROM Products;

-------------------------------------------------------------------------------
-- 3. Average product price
-------------------------------------------------------------------------------
SELECT AVG(price) AS avg_price
FROM Products;

--------------------------------------------------------------------------------
-- 4. Count how many orders each user made
--------------------------------------------------------------------------------
SELECT user_id, COUNT(order_id) AS total_orders
FROM Orders
GROUP BY user_id;

--------------------------------------------------------------------------------
-- 5. payments greater than 50,000
--------------------------------------------------------------------------------
SELECT order_id, SUM(amount) AS total_paid
FROM Payments
GROUP BY order_id
HAVING SUM(amount) > 50000;

--------------------------------------------------------------------------------
-- 6. average product price(rounded to 2 decimals)
--------------------------------------------------------------------------------
SELECT ROUND(AVG(price), 2) AS avg_price
FROM Products;

--------------------------------------------------------------------------------
-- 7. Highest price product
--------------------------------------------------------------------------------
SELECT MAX(price) AS highest_price
FROM Products;

--------------------------------------------------------------------------------
-- 8. lowest price product
--------------------------------------------------------------------------------
SELECT MIN(price) AS lowest_price
FROM Products;

---------------------------------------------------------------------------------
-- 9. Count distinct emails in Users table
---------------------------------------------------------------------------------
SELECT COUNT(DISTINCT email) AS unique_emails
FROM Users;